# OggLogErrSend

При переносе на сервер OGG

1. Раскомментировать строки в файле model.py

2. Изменить параметры скрипта в params.py
    - Указать начальную дату поиска ошибок в логе
        p_start_date = '2016-01-01 00:00:00'
    - Указать полный путь к файлам в Unix/Linux
        p_system_log = 'full_path' - путь к файлу лога системы OGG
        p_logfile = 'full_path' - путь к целевому лог файлу, созданному на основе 500000 строк лога OGG
        p_checkfile = 'full_path' - путь файлу, хранящему дату последней прочитанной строки из последнего запуска скрипта
        p_dirrpt = 'full_path' - путь к хранилищу подробных отчетов по ошибкам
    - Указать адрес почтового сервера, отправителя, получателей сообщений об ошибках и тему письма
        p_smtp_server = 'smtp_server'
        p_send_from = 'email_from'
        p_send_to = ['email_to_1', 'email_to_2', 'email_to_3']
        p_subject = 'email_subject'


---------------------------------------------------------------------------------------------------------------------
Файл параметров params.py
Указываем начальную дату мониторинга, которая используется при первом запуске и в случае неверного формата даты в файле check
p_start_date = '2016-01-01 00:00:00'

Указываем расположение системного лога OGG
p_system_log = 'OGG_HOME/ggserr.log'

Указываем расположение проверяемого лога
p_logfile = '/oracle/send_ogg_error/files/ggserr_test.log'

Указываем расположение файла, который хранит последнею дату из последнего проверенного лога, для исключения повторной отсылки одних и тех же ошибок
p_checkfile = '/oracle/send_ogg_error/files/check'

Указываем расположение каталога dirrpt для прикрепления к письму отчетов по ошибкам
p_dirrpt = ‘OGG_HOME/dirrpt/'

Указываем темповую директорию в системе. В данной директории создаются архивы подробных отчетов, прикрепляемых при необходимости к письму.
p_temp_dir = '/tmp/'

Указываем настройки почты
p_smtp_server = 'smtp.sbrf.ru'
p_send_from = Email_from'
p_send_to = [‘Email1_to', ‘Email2_to']
p_mail_subject = ‘Тема письма‘

Указываем количество последних строк системного лога OGG, которые скрипт будет обрабатывать.
p_tail_number = -500000
---------------------------------------------------------------------------------------------------------------------

Пример настройки crontab на Solaris

#!/usr/bin/bash
0,15,30,45 * * * * /usr/bin/python /oracle/send_ogg_error/start.py >> /oracle/send_ogg_error/files/cron.log

---------------------------------------------------------------------------------------------------------------------
